<!DOCTYPE html>
<html lang="es"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Detectando movimiento con opencv - Blog de Fabio Rueda</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="alternate" hreflang="es" href="http://blog.fabio.xyz" />



<link rel="canonical" href="http://blog.fabio.xyz/drafts/detectando-movimiento-con-opencv.html">

        <meta name="author" content="Fabio Rueda" />
        <meta name="keywords" content="python,opencv,numpy,matplotlib" />
        <meta name="description" content="Introduccion Me he pillao una serpiente, eso es asi, es una Thamnophis Sirtalis. Lleva en su terrario 3 dias y aun esta muy asustada, el caso es que se me ocurrio una de mis frikadas con este asunto, es bastante sencilla. Tambien me he pillado un odroid C1. Lo tendre ..." />

    <!-- Enable latex plugin -->



    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@avances123">
        <meta name="twitter:creator" content="@avances123">
    <meta name="twitter:domain" content="http://blog.fabio.xyz">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.fabio.xyz/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://blog.fabio.xyz/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.fabio.xyz/theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.fabio.xyz/theme/css/style.css" type="text/css"/>

        <link href="http://blog.fabio.xyz/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Blog de Fabio Rueda ATOM Feed"/>


        <link href="http://blog.fabio.xyz/feeds/python.atom.xml" type="application/atom+xml" rel="alternate"
              title="Blog de Fabio Rueda python ATOM Feed"/>

    

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.fabio.xyz/" class="navbar-brand">
Blog de Fabio Rueda            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="http://blog.fabio.xyz/category/javascript.html">Javascript</a>
                        </li>
                        <li >
                            <a href="http://blog.fabio.xyz/category/postgresql.html">Postgresql</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.fabio.xyz/category/python.html">Python</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.fabio.xyz/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archivo</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.fabio.xyz/drafts/detectando-movimiento-con-opencv.html"
                       rel="bookmark"
                       title="Permalink to Detectando movimiento con opencv">
                        Detectando movimiento con opencv
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">




<span class="label label-default">Tags</span>
	<a href="http://blog.fabio.xyz/tag/python.html">python</a>
        /
	<a href="http://blog.fabio.xyz/tag/opencv.html">opencv</a>
        /
	<a href="http://blog.fabio.xyz/tag/numpy.html">numpy</a>
        /
	<a href="http://blog.fabio.xyz/tag/matplotlib.html">matplotlib</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h2>Introduccion</h2>
<p>Me he pillao una serpiente, eso es asi, es una <a href="http://es.wikipedia.org/wiki/Thamnophis_sirtalis">Thamnophis Sirtalis</a>. Lleva en su terrario 3 dias y aun esta muy asustada, el caso es que se me ocurrio una de mis frikadas con este asunto, es bastante sencilla.</p>
<p>Tambien me he pillado un <a href="http://www.hardkernel.com/main/products/prdt_info.php">odroid C1</a>. Lo tendre encendido siempre, y lo uso como servidor casero, para la VPN, para el torrent, lo tipico.</p>
<h2>La vida de Json</h2>
<p>Json, como se llama la culebra, esta mucho tiempo a solas, supongo que para su felicidad. El caso es que yo lo quiero mucho mas que el a mi, y lo quiero ver, asi que he montado un sistema con la <a href="http://www.trust.com/en/all-products/17676-elight-full-hd-1080p-webcam">webcam</a> y el <a href="http://www.hardkernel.com/main/products/prdt_info.php">odroid</a>, que tira fotos cada minuto, y las deja un directorio, la ultima de ellas, la servire con el apache del odroid y asi tengo el terrario controlado.</p>
<p>Existe un programa llamado fswebcam (esta en los repos de ubuntu), que sirve precisamente para esto, tira la foto y la guarda, no hay mucho mas.</p>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="nb">cd</span> /home/odroid/serpiente/
<span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date +<span class="s2">&quot;%Y-%m-%d_%H%M&quot;</span><span class="k">)</span>
fswebcam -v -r 800x640  -D <span class="m">3</span> -S <span class="m">4</span> <span class="nv">$DATE</span>.jpg
ln -fs <span class="k">$(</span>ls -1 2015* <span class="p">|</span> tail -n1<span class="k">)</span> current.jpg
</pre></div>


<p>Este script es una chapuza y lo que querais, pero bueno la idea es simple, la ultima linea hace un link simbolico de la ultima foto a "current.jpg".</p>
<p>Este script lo ponemos en el cron del odroid para que se ejecute cada minuto.</p>
<div class="highlight"><pre>* * * * * /home/odroid/timelapse-webcam.sh 2&gt;&amp;1 &gt;&gt;/tmp/timelapse.log
</pre></div>


<p>Faltaria hacer un virtualhost en nuestro apache para servir esta carpeta y currarte si quieres un html para mostrar current.jpg algo bonito.Yo solo sirvo la imagen y me sirve para verla desde el movil, podeis <a href="http://casa.fabio.xyz/serpiente/current.jpg">verla en tiempo real</a></p>
<h2>Detectando movimiento</h2>
<p>Estos primeros dias , la culebra esta muy asustada, tiene un tronco hueco donde poderse esconder y alli pasa el 95% de su tiempo, como es rollazo estar mirando a ver que produce, he pensado en aprender algo sobre la tipico problema de detector de movimiento, hacer algo asi, y que me avise si sale del tronco o si bebe agua, esa es la idea.</p>
<p>Segun <a href="https://blog.cedric.ws/opencv-simple-motion-detection">he leido</a>, para detectar el movimiento, usaremos la tecnica "Differential Images" que consiste en restar una imagen a otra anterior</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5455185a630e0def"></script>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'avances123'; // required: replace example with your forum shortname

                    var disqus_identifier = 'detectando-movimiento-con-opencv';
                var disqus_url = 'http://blog.fabio.xyz/drafts/detectando-movimiento-con-opencv.html';

            var disqus_config = function () {
                this.language = "es";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="/pages/acerca-de-mi.html"><i class="fa fa-graduation-cap"></i> Acerca de</a></li>
                    <li class="list-group-item"><a href="http://twitter.com/avances123"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                    <li class="list-group-item"><a href="https://plus.google.com/u/0/+FabioRuedaCarrascosa/posts"><i class="fa fa-google-plus-square fa-lg"></i> Google+</a></li>
                    <li class="list-group-item"><a href="https://www.linkedin.com/pub/fabio-rueda-carrascosa/15/619/394"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
                  </ul>
                </li>



    <li class="list-group-item"><h4><i class="fa fa-cogs fa-lg"></i><span class="icon-label">Proyectos</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <i class="fa fa-bitcoin"></i>
            <a href="http://www.cloudtrum.xyz" target="_blank">
                Cloudtrum
            </a>
        </li>
      </ul>
    </li>

    <li class="list-group-item"><h4><a href="https://github.com/avances123"><i class="fa fa-github fa-lg"></i></a><span class="icon-label">Ultimos commits</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </li>
            

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Fabio Rueda              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" height="15" width="80"/></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.fabio.xyz/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.fabio.xyz/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.fabio.xyz/theme/js/respond.min.js"></script>

    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://blog.fabio.xyz/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'avances123',
                count: 3,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://blog.fabio.xyz/theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'avances123'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-18805523-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->
</body>
</html>


